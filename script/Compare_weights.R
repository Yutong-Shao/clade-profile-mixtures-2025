
library(ggplot2)
library(dplyr)
library(tidyr)

fix <- c(0.0169698865, 0.0211683374, 0.0276589079, 0.0065675964, 0.0141221416, 0.0068774834, 0.0146909701, 0.0067225777, 0.0018396660, 0.0102547197,
         0.0230896163, 0.0057941033, 0.0125394534, 0.0204526478, 0.0070629602, 0.0117982741, 0.0068334668, 0.0433775839, 0.0318278731, 0.0222546108,
         0.0102264969, 0.0150545891, 0.0134159878, 0.0148552065, 0.0239111516, 0.0128776278, 0.0222318842, 0.0247444742, 0.0214274810, 0.0115001882,
         0.0076017389, 0.0130258568, 0.0093701965, 0.0467194264, 0.0441940314, 0.0322263154, 0.0402999891, 0.0150234227, 0.0104589903, 0.0214742395,
         0.0154957836, 0.0101789953, 0.0227980379, 0.0123204539, 0.0066777583, 0.0004150083, 0.0344385130, 0.0113663379, 0.0127143049, 0.0124323741,
         0.0262124415, 0.0064994957, 0.0103203293, 0.0142463512, 0.0215600067, 0.0199150700, 0.0038964200, 0.0113448855, 0.0128595846, 0.0117656776)

opt <- c(0.0201778931, 0.0328566366, 0.0231314327, 0.0095596322, 0.0148166894, 0.0097622038, 0.0084440690, 0.0102798648, 0.0026087290, 0.0160752384,
         0.0435165706, 0.0081389173, 0.0103665755, 0.0119395355, 0.0000063796, 0.0096106602, 0.0110343738, 0.0374101011, 0.0274872496, 0.0147534735,
         0.0068010478, 0.0133772699, 0.0133129846, 0.0191938632, 0.0219530040, 0.0095826796, 0.0323065003, 0.0233101183, 0.0157393590, 0.0149812688,
         0.0158300686, 0.0143830871, 0.0079384430, 0.0506051277, 0.0351670596, 0.0279150840, 0.0207820557, 0.0224018086, 0.0093744193, 0.0300708148,
         0.0087097631, 0.0057819865, 0.0466535687, 0.0103833320, 0.0043300890, 0.0002674216, 0.0149682182, 0.0084921318, 0.0160656837, 0.0059612300,
         0.0290989298, 0.0095416255, 0.0097492808, 0.0174285699, 0.0265117776, 0.0276138708, 0.0021600545, 0.0152021946, 0.0076984209, 0.0063795614)

df <- data.frame(
  Profile = factor(1:60),
  Fix = fix,
  Opt = opt
) %>%
  pivot_longer(cols = c(Fix, Opt), names_to = "Type", values_to = "Weight")

# Plot
ggplot(df, aes(x = Profile, y = Weight, color = Type, group = Type)) +
  geom_line() +
  geom_point(size = 1.2) +
  labs(title = "Comparison of Fix and Opt Weights (LG-C60-PMSF)",
       x = "Profile Index",
       y = "Weight",
       color = "Model") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

#ggsave("Compare_weights.jpg", plot = p, width = 9, height = 4, dpi = 300)

# Calculate absolute differences
diff <- fix - opt

# Extract the top 10
top10_indices <- order(abs(diff), decreasing = TRUE)[1:10]

data.frame(
  Profile = paste0("C60_", top10_indices),
  Fix = fix[top10_indices],
  Opt = opt[top10_indices],
  Difference = diff[top10_indices]
)
