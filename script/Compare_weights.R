
library(ggplot2)
library(dplyr)
library(tidyr)

## C60

fix_C60 <- c(0.0169698865, 0.0211683374, 0.0276589079, 0.0065675964, 0.0141221416, 0.0068774834, 0.0146909701, 0.0067225777, 0.0018396660, 0.0102547197,
         0.0230896163, 0.0057941033, 0.0125394534, 0.0204526478, 0.0070629602, 0.0117982741, 0.0068334668, 0.0433775839, 0.0318278731, 0.0222546108,
         0.0102264969, 0.0150545891, 0.0134159878, 0.0148552065, 0.0239111516, 0.0128776278, 0.0222318842, 0.0247444742, 0.0214274810, 0.0115001882,
         0.0076017389, 0.0130258568, 0.0093701965, 0.0467194264, 0.0441940314, 0.0322263154, 0.0402999891, 0.0150234227, 0.0104589903, 0.0214742395,
         0.0154957836, 0.0101789953, 0.0227980379, 0.0123204539, 0.0066777583, 0.0004150083, 0.0344385130, 0.0113663379, 0.0127143049, 0.0124323741,
         0.0262124415, 0.0064994957, 0.0103203293, 0.0142463512, 0.0215600067, 0.0199150700, 0.0038964200, 0.0113448855, 0.0128595846, 0.0117656776)

opt_LGC60 <- c(0.0201778931, 0.0328566366, 0.0231314327, 0.0095596322, 0.0148166894, 0.0097622038, 0.0084440690, 0.0102798648, 0.0026087290, 0.0160752384,
         0.0435165706, 0.0081389173, 0.0103665755, 0.0119395355, 0.0000063796, 0.0096106602, 0.0110343738, 0.0374101011, 0.0274872496, 0.0147534735,
         0.0068010478, 0.0133772699, 0.0133129846, 0.0191938632, 0.0219530040, 0.0095826796, 0.0323065003, 0.0233101183, 0.0157393590, 0.0149812688,
         0.0158300686, 0.0143830871, 0.0079384430, 0.0506051277, 0.0351670596, 0.0279150840, 0.0207820557, 0.0224018086, 0.0093744193, 0.0300708148,
         0.0087097631, 0.0057819865, 0.0466535687, 0.0103833320, 0.0043300890, 0.0002674216, 0.0149682182, 0.0084921318, 0.0160656837, 0.0059612300,
         0.0290989298, 0.0095416255, 0.0097492808, 0.0174285699, 0.0265117776, 0.0276138708, 0.0021600545, 0.0152021946, 0.0076984209, 0.0063795614)

opt_LGC60_1kp <- c(0.0287878317, 0.0004416573, 0.0043424533, 0.0039224583, 0.0179933388, 0.0109535022, 0.0007961256, 0.0029958142, 0.0089738988, 0.1253156622, 0.0196237586, 0.0053232137, 0.0036529666, 0.0123647123, 0.0020210785, 0.0104325397, 0.0574119005, 0.0287245271, 0.0065629644, 0.0040312800, 0.0025770028, 0.0236593074, 0.0027325244, 0.0000001253, 0.0065697533, 0.0126244702, 0.0186632420, 0.0529963694, 0.0361863301, 0.0458784257, 0.0035694465, 0.0126269613, 0.0139890193, 0.0121352457, 0.0247742646, 0.0050224720, 0.0051200855, 0.0174804380, 0.0024129132, 0.0055196817, 0.0032703908, 0.0060558428, 0.0150156492, 0.0391697453, 0.0265342615, 0.0015173253, 0.0063036506, 0.0067545763, 0.0013454468, 0.0805279153, 0.0072300613, 0.0471462878, 0.0016622693, 0.0081594362, 0.0491478178, 0.0054736022, 0.0051057358, 0.0231780465, 0.0070668612, 0.0001253157)

opt_GTRC60 <- c(0.0149, 0.0150, 0.0142, 0.0151, 0.0287, 0.0173, 0.0053, 0.0072, 0.0094, 0.0509, 0.0159, 0.0113, 0.0045, 0.0107, 0.0001, 0.0105, 0.0203, 0.0368, 0.0446, 0.0069, 0.0031, 0.0189, 0.0099, 0.0076, 0.0106, 0.0362, 0.0378, 0.0423, 0.0202, 0.0157, 0.0060, 0.0143, 0.0199, 0.0237, 0.0290, 0.0143, 0.0122, 0.0298, 0.0028, 0.0207, 0.0052, 0.0035, 0.0221, 0.0078, 0.0077, 0.0004, 0.0238, 0.0110, 0.0091, 0.0148, 0.0154, 0.0162, 0.0077, 0.0105, 0.0634, 0.0117, 0.0063, 0.0353, 0.0090, 0.0045)

opt_PoiC60 <- c(0.0193254332, 0.0323032225, 0.0241793749, 0.0096145358, 0.0146273231, 0.0097702907, 0.0085196484, 0.0102334959, 0.0026473895, 0.0160134541, 0.0437979958, 0.0080811066, 0.0103722080, 0.0120488477, 0.0000045594, 0.0097652842, 0.0110953758, 0.0352282024, 0.0270188696, 0.0146611930, 0.0069096599, 0.0134005990, 0.0132356108, 0.0222089196, 0.0219047636, 0.0095522693, 0.0328659224, 0.0228310975, 0.0148314482, 0.0149535041, 0.0159061902, 0.0144118326, 0.0079261235, 0.0497455072, 0.0351846459, 0.0279761792, 0.0210454180, 0.0227795166, 0.0093534091, 0.0314615496, 0.0086984882, 0.0058461616, 0.0474015756, 0.0102821476, 0.0043823369, 0.0004222744, 0.0149128069, 0.0083712002, 0.0163511184, 0.0062235481, 0.0290956857, 0.0095979991, 0.0096608099, 0.0175072128, 0.0268086807, 0.0272182144, 0.0021692713, 0.0150942222, 0.0076048574, 0.0045594119)

## UDM64

fix_UDM64 <- c(0.02727713454628415, 0.026957736839103404, 0.023113557291963724, 0.02249472423430103, 0.021604973478583242, 0.02141675697256602, 0.020934808646552217, 0.02056407916500314, 0.020187646152968686, 0.020002281412194147, 0.019956653168311186, 0.01959447898249016, 0.019454742485598586, 0.019352078936861916, 0.018830205897450523, 0.018738949409684593, 0.018542177607939313, 0.018405292876290422, 0.018148634004448754, 0.017968972794159585, 0.01772657274853134, 0.01708777733416985, 0.016799749044658644, 0.01648605486796327, 0.01589573946272743, 0.015713226487195572, 0.015701819426224832, 0.01565619118234187, 0.01551930645069298, 0.015419494667198996, 0.015399532310500199, 0.015140021673415844, 0.015105800490503621, 0.015057320481377973, 0.01495750869788399, 0.014840586322933896, 0.01477214395710945, 0.0145696686248788, 0.01450407802429704, 0.014392859179832317, 0.014324416814007871, 0.014284492100610278, 0.013962242628186848, 0.01385387554896481, 0.01354303313751212, 0.013255004848000913, 0.012921348314606741, 0.012761649461016369, 0.012507842354417384, 0.012311070552672105, 0.012065818741801175, 0.011700792790737467, 0.011640905720641076, 0.011372839787828666, 0.010742599669195232, 0.010582900815604859, 0.01045742314492671, 0.010349056065704671, 0.010229281925511893, 0.0096874465294017, 0.009328124108823362, 0.009040095819312154, 0.0077881708777733415, 0.006998231905549535
)

opt_UDM64 <- c(0.0050724639, 0.0525533008, 0.0176594120, 0.0196967091, 0.0000002428, 0.0087980118, 0.0088959569, 0.0137847467, 0.0028001829, 0.0191818442, 0.0083584008, 0.0000002428, 0.0123334056, 0.0115778894, 0.0192438185, 0.0249486373, 0.0009792210, 0.0103468333, 0.0116411697, 0.0091363635, 0.0041653335, 0.0100621608, 0.0064313765, 0.0105827541, 0.0000002428, 0.0426612863, 0.0161271946, 0.0074067923, 0.0055170127, 0.0227168781, 0.0000002428, 0.0276017780, 0.0145052575, 0.0061241679, 0.0094258964, 0.0094642834, 0.0331439296, 0.0033257595, 0.0049210361, 0.0085562768, 0.0106820174, 0.1001460804, 0.0082430086, 0.0149185167, 0.0000002428, 0.0277141429, 0.0054946686, 0.0000002428, 0.0201248081, 0.0025434877, 0.0144033467, 0.0368892067, 0.0342714923, 0.0542241293, 0.0228294841, 0.0078509534, 0.0067165483, 0.0353444293, 0.0000002428, 0.0036408397, 0.0756179087, 0.0132807902, 0.0050720886, 0.0002428114
)


df <- data.frame(
  Profile = factor(1:60),
  Fix = fix_C60,
  Opt = opt_LGC60_1kp
) %>%
  pivot_longer(cols = c(Fix, Opt), names_to = "Type", values_to = "Weight")



# Plot
ggplot(df, aes(x = Profile, y = Weight, color = Type, group = Type)) +
  geom_line() +
  geom_point(size = 1.2) +
  scale_color_manual(values = c("Fix" = "#5B9BD5", "Opt" = "#C16E71")) +
  labs(title = "Comparison of Fix and Opt Weights (LG-UDM64-PMSF)",
       x = "Profile Index",
       y = "Weight",
       color = "Model") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))

#ggsave("Compare_weights_UDM64.jpg", plot = p, width = 9, height = 4, dpi = 300)

# Calculate absolute differences
diff <- fix_UDM64 - opt_UDM64

# Extract the top 10
top10_indices <- order(abs(diff), decreasing = TRUE)[1:10]

data.frame(
  Profile = paste0("C60_", top10_indices),
  Fix = fix_UDM64[top10_indices],
  Opt = opt_UDM64[top10_indices],
  Difference = diff[top10_indices]
)
