legend.position = "top",
legend.margin = margin(b = 5),
legend.title = element_blank(),
legend.text = element_text(size = 7)
) +
labs(x = "div") +
scale_fill_manual(values = c(
"fix" = "#9AC4DB",
"opt" = "#CB8D8B",
"default" = "grey70"
))
# 2. Labels plot
label_background <- combined_data %>%
select(label, group) %>%
distinct() %>%
mutate(ypos = seq(from = 1, by = 2, length.out = n()))
p_labels <- ggplot(label_background, aes(x = 2, y = ypos, fill = group)) +
geom_tile(width = 3.7, height = 2.0) +
scale_fill_manual(values = c(
"CXX-PMSF" = "#E9CDDF",
"UDM-PMSF" = "#C8BFD9",
"MEOW-PMSF" = "#B6C9C0"
)) +
geom_text(aes(label = label, y = ypos),
hjust = 1,
size = 2.5,
nudge_x = 1.8
) +
scale_y_reverse(expand = expansion(add = c(-1, 1))) +
theme_void() +
theme(
legend.position = "none"
) +
coord_cartesian(clip = "off", xlim = c(0.3, 3.58))
p_labels <- p_labels + theme(plot.margin = margin(0.5, 0.14, 0, -0))
p_ridges <- p_ridges + theme(plot.margin = margin(0, 0, 0, 0))
# 3. Bar plot
bar_data <- combined_data %>%
group_by(label, weights) %>%
summarise(
div_mean = mean(diversity),
div_mean_adj = abs(mean(diversity) - marked_x),
.groups = "drop"
)
diff_data <- bar_data %>%
group_by(label) %>%
summarise(
fix_value = ifelse(any(weights == "fix"), div_mean_adj[weights == "fix"], NA),
opt_value = ifelse(any(weights == "opt"), div_mean_adj[weights == "opt"], NA),
.groups = "drop"
) %>%
mutate(
diff = ifelse(!is.na(fix_value) & !is.na(opt_value), fix_value - opt_value, 0),
direction = ifelse(diff >= 0, "positive", "negative")
) %>%
select(label, diff, direction)
diff_data$label <- factor(diff_data$label, levels = levels(combined_data$label))
p_bars <- ggplot(diff_data, aes(x = diff, y = label, fill = direction)) +
geom_col(width = 0.9) +
geom_vline(xintercept = 0, color = "black", linewidth = 0.5) +
scale_fill_manual(values = c(
"positive" = "#C16E71",
"negative" = "#5B9BD5"
)) +
scale_y_discrete(
expand = expansion(mult = c(0.01, -0.7))
) +
scale_x_continuous(
breaks = c(-0.15, -0.1, -0.05, 0, 0.05, 0.1),
labels = function(x) abs(x),
limits = c(-0.15, 0.1),
expand = c(0, 0)
) +
theme_void() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
axis.line.x = element_line(color = "black", size = 0.5),
axis.line.y = element_blank(),
legend.position = "none",
plot.margin = margin(0, 5, 0, 0)
)
final_plot_all <- (p_labels + p_ridges + plot_spacer() + p_bars) +
plot_layout(widths = c(0.8, 4, 0.1, 1.3)) &
theme(
plot.margin = margin(5, 5, 2, 0),
panel.spacing = unit(0, "pt")
)
print(final_plot_all)
ggsave("PBT_1kp.png", plot = final_plot_all, width = 10, height = 6, dpi = 900)
combined_data <- combined_data %>%
mutate(group = factor(group, levels = c("CXX-PMSF", "UDM-PMSF"))) %>%
arrange(group, exchangeability, label) %>%
mutate(label = factor(label, levels = rev(unique(label))))
labels <- levels(factor(combined_data$label))
label_positions <- data.frame(
label = labels,
ypos = seq_along(labels)
)
# 1. Main ridge plot
p_ridges <- ggplot(combined_data, aes(x = diversity, y = label, fill = weights)) +
geom_density_ridges(
scale = 1.3,
rel_min_height = 0,
alpha = 0.7,
color = "black",
linewidth = 0.37,
panel_scaling = FALSE,
position = "identity"
) +
geom_segment(
data = label_positions,
aes(x = 4.50, xend = 5.50, y = ypos, yend = ypos),
inherit.aes = FALSE,
color = "black",
linewidth = 0.4
) +
geom_vline(xintercept = marked_x, color = "darkred", linetype = "dashed", linewidth = 0.8) +
scale_x_continuous(
limits = c(4.45, 5.55),
breaks = c(4.50, 4.75, 5.00, 5.25, 5.50),
expand = c(0, 0)
) +
scale_y_discrete(
expand = expansion(add = c(0, 0))
) +
theme_void() +
theme(
axis.title.x = element_text(size = 9),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_line(color = "black", size = 0.5),
axis.line.x = element_line(color = "black", size = 0.5),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.y.left = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
panel.grid.major.x = element_blank(),
legend.position = "top",
legend.margin = margin(b = 5),
legend.title = element_blank(),
legend.text = element_text(size = 7)
) +
labs(x = "div") +
scale_fill_manual(values = c(
"fix" = "#9AC4DB",
"opt" = "#CB8D8B",
"default" = "grey70"
))
# 2. Labels plot
label_background <- combined_data %>%
select(label, group) %>%
distinct() %>%
mutate(ypos = seq(from = 1, by = 2, length.out = n()))
p_labels <- ggplot(label_background, aes(x = 2, y = ypos, fill = group)) +
geom_tile(width = 3.7, height = 2.0) +
scale_fill_manual(values = c(
"CXX-PMSF" = "#E9CDDF",
"UDM-PMSF" = "#C8BFD9",
"MEOW-PMSF" = "#B6C9C0"
)) +
geom_text(aes(label = label, y = ypos),
hjust = 1,
size = 2.5,
nudge_x = 1.8
) +
scale_y_reverse(expand = expansion(add = c(-1, 1))) +
theme_void() +
theme(
legend.position = "none"
) +
coord_cartesian(clip = "off", xlim = c(0.3, 3.58))
p_labels <- p_labels + theme(plot.margin = margin(0.5, 0.14, 0, -0))
p_ridges <- p_ridges + theme(plot.margin = margin(0, 0, 0, 0))
# 3. Bar plot
bar_data <- combined_data %>%
group_by(label, weights) %>%
summarise(
div_mean = mean(diversity),
div_mean_adj = abs(mean(diversity) - marked_x),
.groups = "drop"
)
diff_data <- bar_data %>%
group_by(label) %>%
summarise(
fix_value = ifelse(any(weights == "fix"), div_mean_adj[weights == "fix"], NA),
opt_value = ifelse(any(weights == "opt"), div_mean_adj[weights == "opt"], NA),
.groups = "drop"
) %>%
mutate(
diff = ifelse(!is.na(fix_value) & !is.na(opt_value), fix_value - opt_value, 0),
direction = ifelse(diff >= 0, "positive", "negative")
) %>%
select(label, diff, direction)
diff_data$label <- factor(diff_data$label, levels = levels(combined_data$label))
p_bars <- ggplot(diff_data, aes(x = diff, y = label, fill = direction)) +
geom_col(width = 0.9) +
geom_vline(xintercept = 0, color = "black", linewidth = 0.5) +
scale_fill_manual(values = c(
"positive" = "#C16E71",
"negative" = "#5B9BD5"
)) +
scale_y_discrete(
expand = expansion(mult = c(0.01, -0.7))
) +
scale_x_continuous(
breaks = c(-0.15, -0.1, -0.05, 0, 0.05, 0.1),
labels = function(x) abs(x),
limits = c(-0.15, 0.1),
expand = c(0, 0)
) +
theme_void() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
axis.line.x = element_line(color = "black", size = 0.5),
axis.line.y = element_blank(),
legend.position = "none",
plot.margin = margin(0, 5, 0, 0)
)
final_plot_all <- (p_labels + p_ridges + plot_spacer() + p_bars) +
plot_layout(widths = c(0.8, 4, 0.1, 1.3)) &
theme(
plot.margin = margin(5, 5, 2, 0),
panel.spacing = unit(0, "pt")
)
print(final_plot_all)
ggsave("PBT_1kp.png", plot = final_plot_all, width = 10, height = 6, dpi = 900)
combined_data <- combined_data %>%
mutate(group = factor(group, levels = c("CXX-PMSF", "UDM-PMSF"))) %>%
arrange(group, exchangeability, label) %>%
mutate(label = factor(label, levels = rev(unique(label))))
labels <- levels(factor(combined_data$label))
label_positions <- data.frame(
label = labels,
ypos = seq_along(labels)
)
# 1. Main ridge plot
p_ridges <- ggplot(combined_data, aes(x = diversity, y = label, fill = weights)) +
geom_density_ridges(
scale = 1.3,
rel_min_height = 0,
alpha = 0.7,
color = "black",
linewidth = 0.37,
panel_scaling = FALSE,
position = "identity"
) +
geom_segment(
data = label_positions,
aes(x = 4.50, xend = 5.47, y = ypos, yend = ypos),
inherit.aes = FALSE,
color = "black",
linewidth = 0.4
) +
geom_vline(xintercept = marked_x, color = "darkred", linetype = "dashed", linewidth = 0.8) +
scale_x_continuous(
limits = c(4.45, 5.50),
breaks = c(4.50, 4.75, 5.00, 5.25, 5.50),
expand = c(0, 0)
) +
scale_y_discrete(
expand = expansion(add = c(0, 0))
) +
theme_void() +
theme(
axis.title.x = element_text(size = 9),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_line(color = "black", size = 0.5),
axis.line.x = element_line(color = "black", size = 0.5),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.y.left = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
panel.grid.major.x = element_blank(),
legend.position = "top",
legend.margin = margin(b = 5),
legend.title = element_blank(),
legend.text = element_text(size = 7)
) +
labs(x = "div") +
scale_fill_manual(values = c(
"fix" = "#9AC4DB",
"opt" = "#CB8D8B",
"default" = "grey70"
))
# 2. Labels plot
label_background <- combined_data %>%
select(label, group) %>%
distinct() %>%
mutate(ypos = seq(from = 1, by = 2, length.out = n()))
p_labels <- ggplot(label_background, aes(x = 2, y = ypos, fill = group)) +
geom_tile(width = 3.7, height = 2.0) +
scale_fill_manual(values = c(
"CXX-PMSF" = "#E9CDDF",
"UDM-PMSF" = "#C8BFD9",
"MEOW-PMSF" = "#B6C9C0"
)) +
geom_text(aes(label = label, y = ypos),
hjust = 1,
size = 2.5,
nudge_x = 1.8
) +
scale_y_reverse(expand = expansion(add = c(-1, 1))) +
theme_void() +
theme(
legend.position = "none"
) +
coord_cartesian(clip = "off", xlim = c(0.3, 3.58))
p_labels <- p_labels + theme(plot.margin = margin(0.5, 0.14, 0, -0))
p_ridges <- p_ridges + theme(plot.margin = margin(0, 0, 0, 0))
# 3. Bar plot
bar_data <- combined_data %>%
group_by(label, weights) %>%
summarise(
div_mean = mean(diversity),
div_mean_adj = abs(mean(diversity) - marked_x),
.groups = "drop"
)
diff_data <- bar_data %>%
group_by(label) %>%
summarise(
fix_value = ifelse(any(weights == "fix"), div_mean_adj[weights == "fix"], NA),
opt_value = ifelse(any(weights == "opt"), div_mean_adj[weights == "opt"], NA),
.groups = "drop"
) %>%
mutate(
diff = ifelse(!is.na(fix_value) & !is.na(opt_value), fix_value - opt_value, 0),
direction = ifelse(diff >= 0, "positive", "negative")
) %>%
select(label, diff, direction)
diff_data$label <- factor(diff_data$label, levels = levels(combined_data$label))
p_bars <- ggplot(diff_data, aes(x = diff, y = label, fill = direction)) +
geom_col(width = 0.9) +
geom_vline(xintercept = 0, color = "black", linewidth = 0.5) +
scale_fill_manual(values = c(
"positive" = "#C16E71",
"negative" = "#5B9BD5"
)) +
scale_y_discrete(
expand = expansion(mult = c(0.01, -0.7))
) +
scale_x_continuous(
breaks = c(-0.15, -0.1, -0.05, 0, 0.05, 0.1),
labels = function(x) abs(x),
limits = c(-0.15, 0.1),
expand = c(0, 0)
) +
theme_void() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
axis.line.x = element_line(color = "black", size = 0.5),
axis.line.y = element_blank(),
legend.position = "none",
plot.margin = margin(0, 5, 0, 0)
)
final_plot_all <- (p_labels + p_ridges + plot_spacer() + p_bars) +
plot_layout(widths = c(0.8, 4, 0.1, 1.3)) &
theme(
plot.margin = margin(5, 5, 2, 0),
panel.spacing = unit(0, "pt")
)
print(final_plot_all)
ggsave("PBT_1kp.png", plot = final_plot_all, width = 10, height = 6, dpi = 900)
combined_data <- combined_data %>%
mutate(group = factor(group, levels = c("CXX-PMSF", "UDM-PMSF"))) %>%
arrange(group, exchangeability, label) %>%
mutate(label = factor(label, levels = rev(unique(label))))
labels <- levels(factor(combined_data$label))
label_positions <- data.frame(
label = labels,
ypos = seq_along(labels)
)
# 1. Main ridge plot
p_ridges <- ggplot(combined_data, aes(x = diversity, y = label, fill = weights)) +
geom_density_ridges(
scale = 1.3,
rel_min_height = 0,
alpha = 0.7,
color = "black",
linewidth = 0.37,
panel_scaling = FALSE,
position = "identity"
) +
geom_segment(
data = label_positions,
aes(x = 4.50, xend = 5.47, y = ypos, yend = ypos),
inherit.aes = FALSE,
color = "black",
linewidth = 0.4
) +
geom_vline(xintercept = marked_x, color = "darkred", linetype = "dashed", linewidth = 0.8) +
scale_x_continuous(
limits = c(4.48, 5.50),
breaks = c(4.50, 4.75, 5.00, 5.25, 5.50),
expand = c(0, 0)
) +
scale_y_discrete(
expand = expansion(add = c(0, 0))
) +
theme_void() +
theme(
axis.title.x = element_text(size = 9),
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.y = element_blank(),
axis.line.y = element_line(color = "black", size = 0.5),
axis.line.x = element_line(color = "black", size = 0.5),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.y.left = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
panel.grid.major.x = element_blank(),
legend.position = "top",
legend.margin = margin(b = 5),
legend.title = element_blank(),
legend.text = element_text(size = 7)
) +
labs(x = "div") +
scale_fill_manual(values = c(
"fix" = "#9AC4DB",
"opt" = "#CB8D8B",
"default" = "grey70"
))
# 2. Labels plot
label_background <- combined_data %>%
select(label, group) %>%
distinct() %>%
mutate(ypos = seq(from = 1, by = 2, length.out = n()))
p_labels <- ggplot(label_background, aes(x = 2, y = ypos, fill = group)) +
geom_tile(width = 3.7, height = 2.0) +
scale_fill_manual(values = c(
"CXX-PMSF" = "#E9CDDF",
"UDM-PMSF" = "#C8BFD9",
"MEOW-PMSF" = "#B6C9C0"
)) +
geom_text(aes(label = label, y = ypos),
hjust = 1,
size = 2.5,
nudge_x = 1.8
) +
scale_y_reverse(expand = expansion(add = c(-1, 1))) +
theme_void() +
theme(
legend.position = "none"
) +
coord_cartesian(clip = "off", xlim = c(0.3, 3.58))
p_labels <- p_labels + theme(plot.margin = margin(0.5, 0.14, 0, -0))
p_ridges <- p_ridges + theme(plot.margin = margin(0, 0, 0, 0))
# 3. Bar plot
bar_data <- combined_data %>%
group_by(label, weights) %>%
summarise(
div_mean = mean(diversity),
div_mean_adj = abs(mean(diversity) - marked_x),
.groups = "drop"
)
diff_data <- bar_data %>%
group_by(label) %>%
summarise(
fix_value = ifelse(any(weights == "fix"), div_mean_adj[weights == "fix"], NA),
opt_value = ifelse(any(weights == "opt"), div_mean_adj[weights == "opt"], NA),
.groups = "drop"
) %>%
mutate(
diff = ifelse(!is.na(fix_value) & !is.na(opt_value), fix_value - opt_value, 0),
direction = ifelse(diff >= 0, "positive", "negative")
) %>%
select(label, diff, direction)
diff_data$label <- factor(diff_data$label, levels = levels(combined_data$label))
p_bars <- ggplot(diff_data, aes(x = diff, y = label, fill = direction)) +
geom_col(width = 0.9) +
geom_vline(xintercept = 0, color = "black", linewidth = 0.5) +
scale_fill_manual(values = c(
"positive" = "#C16E71",
"negative" = "#5B9BD5"
)) +
scale_y_discrete(
expand = expansion(mult = c(0.01, -0.7))
) +
scale_x_continuous(
breaks = c(-0.15, -0.1, -0.05, 0, 0.05, 0.1),
labels = function(x) abs(x),
limits = c(-0.15, 0.1),
expand = c(0, 0)
) +
theme_void() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_blank(),
axis.ticks.x = element_line(color = "black", size = 0.5),
axis.ticks.length = unit(0.1, "cm"),
axis.line.x = element_line(color = "black", size = 0.5),
axis.line.y = element_blank(),
legend.position = "none",
plot.margin = margin(0, 5, 0, 0)
)
final_plot_all <- (p_labels + p_ridges + plot_spacer() + p_bars) +
plot_layout(widths = c(0.8, 4, 0.1, 1.3)) &
theme(
plot.margin = margin(5, 5, 2, 0),
panel.spacing = unit(0, "pt")
)
print(final_plot_all)
ggsave("PBT_1kp.png", plot = final_plot_all, width = 10, height = 6, dpi = 900)
